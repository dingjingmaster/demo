#include <stdio.h>
#include <stdlib.h>
#include <string.h>

#include "aes.h"
#include "aes_lib.h"


int main (void)
{
//	int dataLen = 128;
//	char encStr[] = "\xEF\xBF\xBD\xEF\xBF\xBD\xD6\x8CK\xEF\xBF\xBD\xEF\xBF\xBD\xEF\xBF\xBDt2\xEF\xBF\xBD\xEF\xBF\xBD>\xEC\xA5\xA8""F\x02\xEF\xBF\xBDk\xEF\xBF\xBD\xEF\xBF\xBD""f;Ms\xEF\xBF\xBDG)\xEF\xBF\xBD \x14U\xEF\xBF\xBDw\xEF\xBF\xBD\xEF\xBF\xBDz\xEF\xBF\xBD\xEF\xBF\xBD\x10\xEF\xBF\xBDg=`\xEF\xBF\xBDP\xEF\xBF\xBD M\xEF\xBF\xBD\xD0\xBF\x0E\xEF\xBF\xBD\x0E""A`\xEF\xBF\xBD-Qjf\xEF\xBF\xBD\xEF\xBF\xBD\xEF\xBF\xBD\xEF\xBF\xBD\xEF\xBF\xBDr\xEF\xBF\xBD\\\xEF\xBF\xBD\x0F\xE3\xA2\xBC\x7F\xEF\xBF\xBD@\xEF\xBF\xBD\xEF\xBF\xBD\xEF\xBF\xBD\x10#\xEF\xBF\xBDw`\xEF\xBF\xBD\xEF\xBF\xBDuG0~\xEF\xBF\xBD\xEF\xBF\xBD\xEF\xBF\xBD>\x19l\xEF\xBF\xBDw\x12\xEF\xBF\xBD\xEF\xBF\xBD\xD9\x92\xEF\xBF\xBD""9\xEF\xBF\xBD.,;\xEF\xBF\xBD\xEF\xBF\xBD\xC4\xBD\xEF\xBF\xBD\xEF\xBF\xBDV\xEF\xBF\xBD\xEF\xBF\xBD\xEF\xBF\xBD\xCF\x82>\xEF\xBF\xBD\xEF\xBF\xBD\xEF\xBF\xBD";

//	int dataLen = 128;
	//char encStr[] = "\xEF\xBF\xBD\xEF\xBF\xBD""Aji\xEF\xBF\xBD\xEF\xBF\xBD_=\xEF\xBF\xBD\x15\xEF\xBF\xBD\xEF\xBF\xBD\xEF\xBF\xBD\x05\x07Y\x14\xEF\xBF\xBDq]_\x1Ch\xEF\xBF\xBD\x06\xEF\xBF\xBD^\xEF\xBF\xBD\xEF\xBF\xBD\xEF\xBF\xBDK\xEF\xBF\xBD\xEF\xBF\xBD\t\xEF\xBF\xBD\xEF\xBF\xBD\xEF\xBF\xBD\xEF\xBF\xBDL\xEF\xBF\xBD\xEF\xBF\xBD~\x1B""c\xEF\xBF\xBD\xEF\xBF\xBD\xEF\xBF\xBD\x16\xEF\xBF\xBD{j\xDD\x9F\xEF\xBF\xBD""B\xEF\xBF\xBD\xEF\xBF\xBD\xEF\xBF\xBD\x07`7N\xEF\xBF\xBD\x17""CE\xEF\xBF\xBD\xEF\xBF\xBD-Al\xEF\xBF\xBD\xEF\xBF\xBD\x1C\xEF\xBF\xBD[\xEF\xBF\xBD""5\xEF\xBF\xBD\xEF\xBF\xBD\xEF\xBF\xBD\xEF\xBF\xBD\xD2\x85\xD9\x9D\xEF\xBF\xBD\xEF\xBF\xBD""At\xDA\xAD\xEF\xBF\xBD\xEF\xBF\xBD\tJ\xEF\xBF\xBDn\xEF\xBF\xBD\x1CKL\x12\"7e\xD3\xB6\xEF\xBF\xBDhK\xEF\xBF\xBD\x1C\x18""A.\xEF\xBF\xBD\xEF\xBF\xBD&\xEF\xBF\xBD\xEF\xBF\xBD<\xEF\xBF\xBD\xEF\xBF\xBDN\xEF\xBF\xBD\\";

	char encStr[] = "Hello World";
	int dataLen = strlen(encStr);

	char* key = "b60d29aa7475db4d";
	struct AES_ctx ctx;
	AES_init_ctx_iv(&ctx, (unsigned char*)key, (unsigned char*)key);

	//aes_cbc_encrypt(encStr, key, dataLen, key);
	AES_CBC_encrypt_buffer(&ctx, encStr, dataLen);
	printf ("encStr: %s\n", encStr);

	AES_init_ctx_iv(&ctx, (unsigned char*)key, (unsigned char*)key);
	AES_CBC_decrypt_buffer(&ctx, (unsigned char*) encStr, dataLen);

	printf ("encStr: %s\n", encStr);

	return 0;
}
