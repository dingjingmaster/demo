# kernel 0.11

## 从开机加电到执行 main 函数的过程

分三步：
1. 启动 BIOS，准备实模式下的中断向量表和中断服务程序
2. 从启动盘加载操作系统到内存，利用第一步中的中断无法程序读取磁盘上的操作系统到内存
3. 为执行 32 位的 main 函数做过度工作

## 启动BIOS

1. `上电后开始执行BIOS程序`  BIOS 位于 `0xFFFF0` 处；上电后 CS = 0xFFFF，IP =0x0000，CS:IP = 0xFFFF0
2. `BIOS初始化中断向量表`  BIOS 在内存最开始的位置(即:0x00000)用1KB的内存(0x00000 ~ 0x003FF)构建中断向量表，并在紧挨着它的位置用 256 字节的内存构建 BIOS 数据区(0x00400 ~ 0x004FF)，在大约 56KB 以后的位置(0x0E2CE)加载了8KB左右的与中断向量表相应的若干中断服务程序。中断向量表中有 256 个中断向量，每个中断向量占4个字节，其中两个字节是CS的值，两个字节是IP的值，每个中断向量都指向一个具体的中断服务程序。
3. `加载操作系统内核程序`  计算机将分三批次加载操作系统的代码。
    1. 由 BIOS 中断 `int 0x19` (中断服务程序地址在 0x0E6F2 位置处，是由BIOS设置的，会把 0磁头 0磁道 1扇区的内容复制到 0x7C00处)把第一扇区 bootsect 的内容加载到内存(bootsect有512B大小)
    2. 第2批和第3批将在 bootsect 的指挥下分别把其后的 四个扇区 和 随后的 240 个扇区内容加载到内存

> BIOS 一般不同，假设BIOS只有8KB，占据空间 `0xFE000 ~ 0xFFFFF`
